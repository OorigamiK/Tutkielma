\documentclass{article}
\usepackage{amsmath, amssymb, amsthm}  % amssymb for \mathbb, amsthm for lemma
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{cleveref}

\newtheorem{lemma}{Lemma}

\begin{document}
	
	\begin{lemma}
		Let $f:\mathbb{R}\to\mathbb{R}$ be a convex, twice differentiable function such that $f'(x) \ge 0$. Let $g:\mathbb{R}\to\mathbb{R}$ satisfy
		\[
		f(g(x)) \sim x
		\]
		Then
		\[
		g(x) \sim f^{-1}(x)
		\]
	\end{lemma}
	
	\begin{proof}
		From $f(g(x))\sim x$ follows
		\[
		f(g(x))=x+o(x)
		\]
		Taking inverse of $f$
		\[
		g(x)=f^{-1}(x+o(x))
		\]
		Since $f$ is convex and monotonic, we get
		\[
		\begin{split}
		f^{-1}((1+\epsilon)x)&\le(1+\epsilon)f^{-1}(x) \\
		f^{-1}((1-\epsilon)x)&\ge(1-\epsilon)f^{-1}(x)
		\end{split}
		\]
		Hence, 
		\[
		g(x)=f^{-1}(x+o(x))=(1+o(1))f^{-1}(x)\sim f^{-1}(x)
		\]
	\end{proof}
	
	\begin{lemma}\label{lem:tail-dominance}
		Let $f$ be rapidly varying function. Fix $\epsilon>0$, then for sufficiently large $n$
		\[
		\sum_{i=1}^{n} f(i)<\sum_{i=n+1}^{n(1+\epsilon)} f(i)
		\]
	\end{lemma}
	
	\begin{proof}
		We will prove that the ratio tends to infinity. We examine the left-hand side
		\[
		\sum_{i=1}^{n}f(i)<nf(n)
		\]
		On the right-hand side
		\[
		\sum_{i=n+1}^{n(1+\epsilon)}f(i)>n\frac{\epsilon}{2} f(n(1+\frac{\epsilon}{2}))
		\]
		Inspecting the ratio
		\[
		\frac{\sum_{i=n+1}^{n(1+\epsilon)} f(i)}{\sum_{i=1}^{n} f(i)}>\frac{n\frac{\epsilon}{2} f(n(1+\frac{\epsilon}{2}))}{nf(n)}>\frac{\epsilon}{2}\frac{f(n(1+\frac{\epsilon}{2}))}{f(n)}
		\]
		Since $f$ is rapidly varying function
		\[
		\lim_{n\rightarrow \infty} \frac{f(n(1+\frac{\epsilon}{2}))}{f(n)}=\infty
		\]
		So there exits $N$ such that
		\[
		\frac{f(n(1+\frac{\epsilon}{2}))}{f(n)}>\frac{2}{\epsilon}, n>N
		\]
	\end{proof}
	
	\begin{lemma}\label{lem:sumfAsymp}
		Let $f\in RV_\alpha$. The sum 
		\[\sum_{i=1}^{n} f(i)\]
		has asymptotic
		\[\frac{1}{1+\alpha}L(n)n^{\alpha+1}\]
	\end{lemma}
	
	\begin{proof}
		Using $f$'s asymptotic
		\[
		\sum_{i=1}^{n}f(i)\sim\sum_{i=1}^{n} i^{\alpha}L(i)
		\]
		The head does not affect the asymptotic
		\[
		\sim\sum_{i=n\epsilon}^{n} i^{\alpha}L(i)
		\]
		Since $L$ is SV, $\frac{L(\lambda x)}{L(x)}\to 1$ uniformly on compact sets. Take $\lambda\in[\epsilon, 1]$
		\[
		\sim\sum_{i=n\epsilon}^{n} i^{\alpha}L(n)
		\]
		Take the $L(n)$ out of the sum
		\[
		\sim L(n)\sum_{i=n\epsilon}^{n} i^{\alpha}
		\]
		Clearly
		\[
		\sim L(n)\int_{n\epsilon}^{n} t^{\alpha}dt
		\]
		Calculate the integral
		\[
		=\frac{1}{1+\alpha}L(n)n^{\alpha+1}(1-\epsilon^{1+\alpha})
		\]
		Follows
		\[
		\sim \frac{1}{1+\alpha}L(n)n^{\alpha+1}
		\]
	\end{proof}
	
	
	
	\begin{lemma}\label{lem:nSquaredIsLittle-o-sumInvF-case-a>1}
		Given monotonic regularly varying $f\sim x^{\alpha}L(x), \alpha>1$. Let $n$ be such that
		\[
		\sum_{i=1}^{n} f(i)\le x<\sum_{i=1}^{n+1} f(i)
		\]
		If  $\frac{L(xL^{\beta}(x))}{L(x)}\sim 1$ locally uniformly $\beta\in\mathbb{R}$ and $L$ is increasing and unbounded, then
		\[
		\sum_{k=1}^{n} f^{-1}(\frac{x}{k}))\sim C(\alpha)n^2
		\]
		Where $C(\alpha)=\frac{\alpha}{(\alpha-1)(1+\alpha)^{\frac{1}{\alpha}}}$
	\end{lemma}
	
	\begin{proof}
		From corollary 2.3.4 in \cite{bingham1987regular} it follows that
		\[
		f^{-1}(x)\sim x^{\frac{1}{\alpha}}\tilde{L}^{-\frac{1}{\alpha}}(x^{\frac{1}{\alpha}})\sim
		x^{\frac{1}{\alpha}}\frac{1}{L^{\frac{1}{\alpha}}(x^{\frac{1}{\alpha}})}
		\]
		Now we inspect
		\[
		\sum_{k=1}^{n} f^{-1}(\frac{x}{k})
		\]	
		Using $f^{-1}$ asymptotic
		\[
		\sim \sum_{k=1}^{n} (\frac{x}{k})^{\frac{1}{\alpha}}\frac{1}{L^{\frac{1}{\alpha}}(\frac{x}{k})}
		\]
		Take the $x$ out of the sum
		\[
		=x^{\frac{1}{\alpha}}\sum_{k=1}^{n} k^{-\frac{1}{\alpha}}\frac{1}{L^{\frac{1}{\alpha}}((\frac{x}{k})^{\frac{1}{\alpha}})}
		\]
		The head of sum does not affect the asymptotic
		\[
		\sim x^{\frac{1}{\alpha}}\sum_{k=n\epsilon}^{n} k^{-\frac{1}{\alpha}}\frac{1}{L^{\frac{1}{\alpha}}((\frac{x}{k})^{\frac{1}{\alpha}})}
		\]
		Since $L^{\frac{1}{\alpha}}(x^{\frac{1}{\alpha}})$ is SV, $\frac{L^{\frac{1}{\alpha}}((\lambda x)^{\frac{1}{\alpha}})}{L^{\frac{1}{\alpha}}(x^{\frac{1}{\alpha}})}\to 1$ uniformly on compact sets. Take $\lambda\in[\epsilon, 1]$
		\[
		\sim x^{\frac{1}{\alpha}}\sum_{k=n\epsilon}^{n} k^{-\frac{1}{\alpha}}\frac{1}{L^{\frac{1}{\alpha}}((\frac{x}{n})^{\frac{1}{\alpha}})}
		\]
		Take $\frac{1}{L^{\frac{1}{\alpha}}((\frac{x}{n})^{\frac{1}{\alpha}})}$ out of the sum
		\[
		\sim \frac{x^{\frac{1}{\alpha}}}{L^{\frac{1}{\alpha}}((\frac{x}{n})^{\frac{1}{\alpha}})}
		\sum_{k=n\epsilon}^{n} k^{-\frac{1}{\alpha}}
		\]
		Clearly
		\[
		\sim 
		\frac{x^{\frac{1}{\alpha}}}{L^{\frac{1}{\alpha}}((\frac{x}{n})^{\frac{1}{\alpha}})}
		\int_{n\epsilon}^{n} t^{-\frac{1}{\alpha}}dt
		\]
		Calculate the integral
		\[
		= \frac{1}{1-\frac{1}{\alpha}}
		\frac{x^{\frac{1}{\alpha}}}{L^{\frac{1}{\alpha}}((\frac{x}{n})^{\frac{1}{\alpha}})}
		(n^{1-\frac{1}{\alpha}}-(n\epsilon)^{1-\frac{1}{\alpha}})
		\]
		Factor n out
		\[
		=
		\frac{1}{1-\frac{1}{\alpha}}
		\frac{x^{\frac{1}{\alpha}}}{L^{\frac{1}{\alpha}}((\frac{x}{n})^{\frac{1}{\alpha}})}
		n^{1-\frac{1}{\alpha}}
		(1-\epsilon^{1-\frac{1}{\alpha}})
		\]
		We get
		\begin{equation}\label{eq:asympOfInvSum}
			\sim
			\frac{1}{1-\frac{1}{\alpha}}
			\frac{x^{\frac{1}{\alpha}}}{L^{\frac{1}{\alpha}}((\frac{x}{n})^{\frac{1}{\alpha}})}
			n^{1-\frac{1}{\alpha}}
		\end{equation}
		From lemma \ref{lem:sumfAsymp}
		\begin{equation}\label{eq:xReln}
			x\sim\frac{1}{1+\alpha}L(n)n^{\alpha+1}
		\end{equation}
		Using \eqref{eq:xReln} to \eqref{eq:asympOfInvSum}
		\[
		\sum_{k=1}^{n} f^{-1}(\frac{x}{k})
		\sim
		\frac{1}{1-\frac{1}{\alpha}}\frac{(\frac{1}{1+\alpha}L(n)n^{\alpha+1})^{\frac{1}{\alpha}}}{L^{\frac{1}{\alpha}}((\frac{1}{1+\alpha}n^\alpha L(n))^{\frac{1}{\alpha}})}n^{1-\frac{1}{\alpha}}
		\]
		Simplify
		\[
		\sum_{k=1}^{n} f^{-1}(\frac{x}{k})
		\sim
		\frac{1}{1-\frac{1}{\alpha}}\frac{(\frac{1}{1+\alpha}L(n)n^{\alpha+1})^{\frac{1}{\alpha}}}{L^{\frac{1}{\alpha}}(\frac{1}{1+\alpha}n L(n)^{\frac{1}{\alpha}})}n^{1-\frac{1}{\alpha}}
		\]
		Using $\frac{L(xL^{\beta}(x))}{L(x)}\sim 1$ it follows
		\[
		\sum_{k=1}^{n} f^{-1}(\frac{x}{k})
		\sim
		\frac{1}{1-\frac{1}{\alpha}}\frac{(\frac{1}{1+\alpha}L(n)n^{\alpha+1})^{\frac{1}{\alpha}}}{L^{\frac{1}{\alpha}}(n)}n^{1-\frac{1}{\alpha}}
		\]
		Simplify
		\[
		\sum_{k=1}^{n} f^{-1}(\frac{x}{k})
		\sim
		\frac{\alpha}{(\alpha-1)(1+\alpha)^{\frac{1}{\alpha}}}
		n^{2}
		\]
	\end{proof}

	\begin{lemma}\label{lem:nSquaredIsLittle-o-sumInvF-case-a=1}
		Same as \ref{lem:nSquaredIsLittle-o-sumInvF-case-a>1}, but $\alpha=1$.
	\end{lemma}
	
	\begin{proof}
		From proof of \ref{lem:nSquaredIsLittle-o-sumInvF-case-a>1} we get
		\[
		\sum_{k=1}^{n} f^{-1}(\frac{x}{k})
		\sim 
		\frac{x}{L(x)}\int_{n\epsilon}^{n} \frac{1}{t}dt
		\sim
		\frac{x}{L(x)}\log(n)
		\]
		Since $\frac{x}{L(x)}\gtrsim n^2$, the lemma follows.
	\end{proof}
	
	
	
	\bibliographystyle{plain}   % or try alpha, apalike, ieee, etc.
	\bibliography{references}   % name of your .bib file (no .bib extension)
	
\end{document}
